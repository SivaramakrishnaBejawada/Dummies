# Use CentOS as base image
FROM centos:8

# Set environment variable to avoid prompts
ENV JAVA_HOME=/usr/lib/jvm/java-11-openjdk
ENV PATH=$JAVA_HOME/bin:$PATH
ENV JENKINS_HOME=/var/jenkins_home

# Install dependencies and Java 11
RUN dnf -y update && \
    dnf -y install java-11-openjdk java-11-openjdk-devel wget git curl gnupg2 && \
    dnf clean all

# Add Jenkins repository and key
RUN wget -O /etc/yum.repos.d/jenkins.repo https://pkg.jenkins.io/redhat-stable/jenkins.repo && \
    rpm --import https://pkg.jenkins.io/redhat-stable/jenkins.io.key

# Install Jenkins
RUN dnf -y install jenkins && \
    dnf clean all

# Expose Jenkins ports
EXPOSE 8080 50000

# Create Jenkins home volume
VOLUME /var/jenkins_home

# Start Jenkins
CMD ["java", "-jar", "/usr/lib/jenkins/jenkins.war"]
